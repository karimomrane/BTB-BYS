import{a as k,j as e,M as N,U as v}from"./app-DLp2baTw.js";import{A as w}from"./AuthenticatedLayout-C8PA60pM.js";import{D as A,c as m}from"./index-Ds7Afd4s.js";import{I as x}from"./InputError-I5pQr9kR.js";import"./pdfmake-BosuxZz1.js";import"./transition-B4XE1bDt.js";import"./proxy-CgNG2EOp.js";import"./index-CSPPlSGh.js";import"./iconBase-CI9ss45l.js";const M=({articles:p,paniers:u})=>{const{data:s,setData:o,post:h,processing:l,errors:g,reset:y}=k({panier_id:"",articles:[]}),b=(r,t)=>{t?o("articles",[...s.articles,{id:r,ready:!1,extra:!1,quantity:1}]):o("articles",s.articles.filter(d=>d.id!==r))},f=(r,t)=>{const d=s.articles.map(i=>i.id===r?{...i,quantity:parseInt(t,10)}:i);o("articles",d)},j=r=>{r.preventDefault();const t=new FormData;t.append("panier_id",s.panier_id),s.articles.forEach((d,i)=>{t.append(`articles[${i}][id]`,d.id),t.append(`articles[${i}][ready]`,d.ready),t.append(`articles[${i}][extra]`,d.extra),t.append(`articles[${i}][quantity]`,d.quantity)}),h(route("article_paniers.store"),t,{onSuccess:()=>{m.success("Articles ajoutés au panier avec succès!"),y()},onError:d=>{console.error("Validation Errors:",d),m.error("Une erreur s'est produite lors de la validation.")}})};return e.jsxs(w,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Ajouter des articles au panier"}),children:[e.jsx(N,{title:"Ajouter des articles au panier"}),e.jsx(A,{}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800",children:e.jsx("div",{className:"p-6 text-gray-900 dark:text-gray-100",children:e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Panier"}),e.jsxs("select",{value:s.panier_id,onChange:r=>o("panier_id",r.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",children:[e.jsx("option",{value:"",children:"Sélectionner un panier"}),u.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx(x,{message:g.panier_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Articles"}),e.jsx("div",{className:"mt-1 space-y-2",children:p.map(r=>{var t,d,i;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"checkbox",checked:s.articles.some(a=>a.id===r.id),onChange:a=>b(r.id,a.target.checked),className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:r.name}),e.jsx("input",{type:"number",min:"1",value:((t=s.articles.find(a=>a.id===r.id))==null?void 0:t.quantity)||1,onChange:a=>f(r.id,a.target.value),className:"w-16 rounded border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100"})]}),s.articles.some(a=>a.id===r.id)&&e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((d=s.articles.find(a=>a.id===r.id))==null?void 0:d.ready)||!1,onChange:a=>{const c=s.articles.map(n=>n.id===r.id?{...n,ready:a.target.checked}:n);o("articles",c)},className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Prêt"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:((i=s.articles.find(a=>a.id===r.id))==null?void 0:i.extra)||!1,onChange:a=>{const c=s.articles.map(n=>n.id===r.id?{...n,extra:a.target.checked}:n);o("articles",c)},className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Extra"})]})]})]},r.id)})}),e.jsx(x,{message:g.articles,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx(v,{href:route("paniers.index"),className:"px-4 py-2 mr-2 text-sm font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600",children:l?"Enregistrement...":"Enregistrer"})]})]})})})})})]})};export{M as default};
