import{j as e,R as f,r as o,a as q,M as _}from"./app-hp2DkSds.js";import{A as U}from"./AuthenticatedLayout-BR9gs5uZ.js";import{D as F,k as O}from"./index-pReMv3pD.js";import R from"./ExtraArticlesSection-DQ-7_rua.js";import G from"./PanierSelectionSection-DTSDnrB5.js";import{A as L}from"./index-DRyzD03w.js";import{m as p}from"./proxy-AHo0hQNW.js";import"./pdfmake-BosuxZz1.js";import"./transition-BcoYE4QA.js";import"./index-AYP80Eul.js";import"./iconBase-mWDOceSG.js";/* empty css               */L,isCartOpen&&(p.div,closeCart,p.div,selectedPaniers.length>0&&(paniers.filter(a=>selectedPaniers.includes(a.id)).map(a=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Prix Unitaire: ",a.price," DT"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Quantité: ",panierQuantities[a.id]||1]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Total: ",calculatePanierTotal(a)," DT"]}),a.articles&&a.articles.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:"Articles inclus:"}),a.articles.map(l=>e.jsx("div",{className:"ml-4",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[l.name," (x",l.pivot.quantity,")"]})},l.id))]})]},a.id)),paniers.filter(a=>selectedPaniers.includes(a.id)).map(a=>e.jsxs(f.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:a.name}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[a.price," DT"]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:e.jsx("input",{type:"number",value:panierQuantities[a.id]||1,onChange:l=>handleQuantityChange(a.id,parseInt(l.target.value)),min:"1",className:"w-20 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"})}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[calculatePanierTotal(a)," DT"]})]}),a.articles&&a.articles.length>0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-2",children:e.jsx("div",{className:"pl-8",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Article"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Quantité"})]})}),e.jsx("tbody",{children:a.articles.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:l.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:l.pivot.quantity})]},l.id))})]})})})})]},a.id))),selectedExtraArticles.length>0&&(articles.filter(a=>selectedExtraArticles.includes(a.id)).map(a=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.name}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Prix Unitaire: ",a.price," DT"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Quantité: ",extraArticleQuantities[a.id]||1]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Total: ",calculateExtraArticleTotal(a)," DT"]})]},a.id)),articles.filter(a=>selectedExtraArticles.includes(a.id)).map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:a.name}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[a.price," DT"]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:e.jsx("input",{type:"number",value:extraArticleQuantities[a.id]||1,onChange:l=>handleExtraArticleQuantityChange(a.id,parseInt(l.target.value)),min:"1",className:"w-20 rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"})}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[calculateExtraArticleTotal(a)," DT"]})]},a.id))),calculateGrandTotal(),closeCart);const I=({paniers:a,articles:l})=>{const[x,w]=o.useState([]),[g,h]=o.useState({});o.useState(!1),o.useState(!1);const[m,v]=o.useState([]),[y,u]=o.useState({}),{data:j,setData:c,post:T,errors:k,processing:A}=q({date:"",description:"",paniers:[],articles_commandes:[]}),D=t=>{w(r=>{let i;if(r.includes(t)){i=r.filter(n=>n!==t);const s={...g};delete s[t],h(s)}else i=[...r,t],h(s=>({...s,[t]:1}));const d=i.map(s=>({panier_id:s,quantity:g[s]||1}));return c("paniers",d),i})},P=(t,r)=>{h(i=>{const d={...i,[t]:r},s=x.map(n=>({panier_id:n,quantity:d[n]||1}));return c("paniers",s),d})},Q=t=>{v(r=>{let i;if(r.includes(t)){i=r.filter(n=>n!==t);const s={...y};delete s[t],u(s)}else i=[...r,t],u(s=>({...s,[t]:1}));const d=i.map(s=>({article_id:s,quantity:y[s]||1}));return c("articles_commandes",d),i})},S=(t,r)=>{u(i=>{const d={...i,[t]:r},s=m.map(n=>({article_id:n,quantity:d[n]||1}));return c("articles_commandes",s),d})},b=t=>{const r=g[t.id]||1;return t.price*r},N=t=>{const r=y[t.id]||1;return t.price*r},E=()=>{const t=x.reduce((i,d)=>{const s=a.find(n=>n.id===d);return i+b(s)},0),r=m.reduce((i,d)=>{const s=l.find(n=>n.id===d);return i+N(s)},0);return t+r},C=t=>{t.preventDefault();const r=x.map(d=>({panier_id:d,quantity:g[d]||1})),i=m.map(d=>({article_id:d,quantity:y[d]||1}));c("paniers",r),c("articles_commandes",i),T(route("commandes.store"),{onSuccess:()=>{},onError:()=>{O.error("Une erreur s'est produite lors de la création de la commande.")}})};return e.jsxs(U,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Ajouter une commande"}),children:[e.jsx(_,{title:"Ajouter une commande"}),e.jsx(F,{position:"bottom-center",reverseOrder:!1}),e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"py-5",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsx(G,{paniers:a,selectedPaniers:x,handlePanierSelection:D}),e.jsx(R,{articles:l,selectedExtraArticles:m,handleExtraArticleSelection:Q}),e.jsx(p.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},transition:{duration:.5,delay:1},className:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800",children:e.jsx("div",{className:"p-6 text-gray-900 dark:text-gray-100",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400",children:"Date Prévu"}),e.jsx("input",{type:"date",value:j.date,onChange:t=>c("date",t.target.value),min:new Date().toISOString().split("T")[0],className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"}),e.jsx("span",{className:"text-red-500 text-xs",children:k.date})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400",children:"Description (optionnel)"}),e.jsx("textarea",{value:j.description,onChange:t=>c("description",t.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"}),e.jsx("span",{className:"text-red-500 text-xs",children:k.description})]}),x.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400",children:"Détails des Paniers"}),e.jsx("div",{className:"mt-2",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Produit"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Prix Unitaire"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Quantité"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:a.filter(t=>x.includes(t.id)).map(t=>e.jsxs(f.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.name}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[t.price," DT"]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:e.jsx("input",{type:"number",value:g[t.id]||1,onChange:r=>P(t.id,parseInt(r.target.value)),min:"1",className:"w-20 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"})}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[b(t)," DT"]})]}),t.articles&&t.articles.length>0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-2",children:e.jsx("div",{className:"pl-8",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Article"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Quantité"})]})}),e.jsx("tbody",{children:t.articles.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:r.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:r.pivot.quantity})]},r.id))})]})})})})]},t.id))})]})})]}),m.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-400",children:"Détails des Articles Supplémentaires"}),e.jsx("div",{className:"mt-2",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Article"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Prix Unitaire"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Quantité"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:l.filter(t=>m.includes(t.id)).map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.name}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[t.price," DT"]}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:e.jsx("input",{type:"number",value:y[t.id]||1,onChange:r=>S(t.id,parseInt(r.target.value)),min:"1",className:"w-20 rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"})}),e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[N(t)," DT"]})]},t.id))})]})})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["Total: ",E()," DT"]})}),e.jsx(p.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:A,className:"inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:bg-indigo-500 dark:hover:bg-indigo-400",children:"Ajouter"})]})})})]})})]})};export{I as default};
